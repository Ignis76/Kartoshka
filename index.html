<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MotiVMozyre</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Use code with caution. -->
</head>

<body>
    <header>
        <nav>
            <ul>
                <li><button class="nav-button" data-modal="delivery-modal">Доставка</button></li>
                <li><button class="nav-button" data-modal="about-modal">О нас</button></li>
                <li><button class="nav-button" data-modal="contacts-modal">Контакты</button></li>
            </ul>
        </nav>
    </header>

    <!-- Модальные окна -->
    <!-- Модальное окно "Доставка" -->
    <div id="delivery-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">×</span>
            <div class="delivery-section">
                <h2>Доставка</h2>
                <ul>
                    <li>
                        Мы доставляем заказы на следующий день после оформления.</li>
                    <li>Вы можете оформить заказ:</li>
                    <li><strong>По телефону</strong> <a href="tel:+375 (29) 737-90-96">+375 (29) 737-90-96</a></li>
                    <li><strong>Через <a href="https://t.me/starbo_oks"> наш Telegram </a></strong> </li>
                    Иногда товар доступен в день заказа – уточняйте у нас!
                    </li>

                </ul>
            </div>
        </div>
    </div>

    <!-- Модальное окно "О нас" -->
    <div id="about-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">×</span>
            <div class="contacts-section">
                <h2>О нас</h2>
                <h3>Здравствуйте!</h3>
                <ul>
                    <li>Мы новая маленькая компания, которая решила, что нашему городу не хватает счастья. И мы решили,
                        что это самое счастье вы можете получить через наши вкусняшки, а именно - Моти.</li>
                    <li>Мы предоставляем вам обширный выбор моти с разными вкусами, но также у нас можно заказать и
                        другие вкусняшки, которые обязательно должны вам понравиться!</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Модальное окно "Контакты" -->
    <div id="contacts-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">×</span>
            <div class="contacts-section">
                <h2>Контакты</h2>
                <ul>
                    <li><strong>Телефон:</strong> <a href="tel:+375 (29) 737-90-96">+375 (29) 737-90-96</a></li>
                    <li><strong>Email:</strong> <a
                            href="mailto:support@yourcompany.com">support@yourcompany.com</a></li>
                    <li><strong>Адрес:</strong> Мозырский р-он, аг. Криничный, ул. Садовая, д. 10</li>
                    <li><strong>Режим работы:</strong> Пн–Пт: 9:00–18:00, Сб: 10:00–16:00</li>
                </ul>
                <h3>Мы в социальных сетях:</h3>
                <ul>
                    <li><a href="https://vk.com/yourcompany" target="_blank">ВКонтакте</a></li>
                    <li><a href="https://www.instagram.com/lelya.k1980/?hl=ru" target="_blank">Instagram</a></li>
                    <li><a href="https://facebook.com/yourcompany" target="_blank">Facebook</a></li>
                </ul>
                <p>Мы находимся недалеко от станции метро "Примерная". Удобная парковка для клиентов.</p>
                <a href="https://yandex.ru/maps" target="_blank">Посмотреть на карте</a>
            </div>

        </div>
    </div>

    <!-- Ваш основной контент -->
    <main>
        <!-- Ваши секции, например, каталог, корзина и т.д. -->
    </main>


    <div class="hero">
        <h1>Моти в Мозыре</h1>
        <div>
            <h11>Маленько счастье в руках</h11>
        </div>
        <p>Натуральные ингридиенты, доставка, лучшие десерты для вас.</p>
        <div class="buttons">
            <button data-modal="moti-modal">О моти</button>
            <button id="order-button">Заказать</button>
        </div>
    </div>
    <div id="moti-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">×</span>
            <div class="contacts-section">
                <h2>О моти</h2>
                <h3>Маленькое японское чудо!</h3>
                <ul>
                    <li>Моти — это японские рисовые сладости, которые завоевали популярность по всему миру.
                    <li>Нежная текстура и разнообразные начинки делают их любимым лакомством как для детей, так и для
                        взрослых.
                    <li>У нас вы найдёте моти с самыми разными вкусами: классическими и необычными!</li>
                    <li>
                    </li>
                </ul>
                <p>Желаем вам скорее попробовать чудо на вкус!</p>
            </div>
        </div>
    </div>

    </header>
    <h1 class="catalog-title">Каталог</h1>
    <section id="catalog">
        <div class="product-grid">
            <div class="product-card" data-image="index_files/orange.jpg">
                <img src="index_files/orange.jpg" alt="Апельсин" class="product-image">
                <h3 class="product-title">Апельсин</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Апельсин" data-price="5">В корзину</button>
                </div>
            </div>

            <div class="product-card" data-image="index_files/Strawberrieswithmilkchocolate.jpg">
                <img src="index_files/Strawberrieswithmilkchocolate.jpg" alt="Клубника в молочном шоколаде"
                    class="product-image">
                <h3 class="product-title">Клубника в молочном шоколаде</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Клубника в молочном шоколаде" data-price="5">В
                        корзину</button>
                </div>
            </div>

            <div class="product-card" data-image="index_files/honeycakewithnuts.jpg">
                <img src="index_files/honeycakewithnuts.jpg" alt="Медовик с орехами" class="product-image">
                <h3 class="product-title">Медовик с орехами</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Медовик с орехами" data-price="5">В корзину</button>
                </div>
            </div>

            <div class="product-card" data-image="index_files/Chocolatewithraspberries.jpg">
                <img src="index_files/Chocolatewithraspberries.jpg" alt="Шоколад с малиной" class="product-image">
                <h3 class="product-title">Шоколад с малиной</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Шоколад с малиной" data-price="5">В корзину</button>
                </div>
            </div>


            <div class="product-card" data-image="index_files/blackcurrant.jpg">
                <img src="index_files/blackcurrant.jpg" alt="Чёрная смородина" class="product-image">
                <h3 class="product-title">Чёрная смородина</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Чёрная смородина" data-price="5">В корзину</button>
                </div>
            </div>

            <div class="product-card" data-image="index_files/strawberrieswithcreamandwhitechocolate.jpg">
                <img src="index_files/strawberrieswithcreamandwhitechocolate.jpg"
                    alt="Клубника со сливками и белым шоколадом" class="product-image">
                <h3 class="product-title">Клубника со сливками и белым шоколадом</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Клубника со сливками и белым шоколадом"
                        data-price="5">В корзину</button>
                </div>
            </div>

            <div class="product-card" data-image="index_files/Citruswithpoppyseeds.jpg">
                <img src="index_files/Citruswithpoppyseeds.jpg" alt="Цитрус с маком" class="product-image">
                <h3 class="product-title">Цитрус с маком</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Цитрус с маком" data-price="5">В корзину</button>
                </div>
            </div>

            <div class="product-card" data-image="index_files/matchawithstrawberries.jpg">
                <img src="index_files/matchawithstrawberries.jpg" alt="Матча с клубникой" class="product-image">
                <h3 class="product-title">Матча с клубникой</h3>
                <p class="product-price">5 BYN/шт</p>
                <div class="buttons">
                    <button class="add-to-cart" data-product="Матча с клубникой" data-price="5">В корзину</button>
                </div>
            </div>


        </div>







    </section>

    <!-- Модальное окно -->

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-button">×</span>
            <img id="modal-image" class="modal-image" src="" alt="Товар">
            <h2 id="modal-title" class="modal-title"></h2>
            <p id="modal-description" class="modal-description"></p>
            <p id="modal-ingredients" class="modal-ingredients"></p>
        </div>
    </div>


    <div class="cart-button">
        <button id="cart-icon">🛒</button>
        <span id="cart-counter">0</span>
        <!-- Счётчик общего количества товаров -->
        <div id="cart-popup">
            <span id="cart-close" class="close-button">×</span>
            <h3>Ваши товары:</h3>
            <ul id="cart-items">
                <!-- Здесь будут отображаться добавленные товары -->
            </ul>
            <p id="total-price">Итого: 0 BYN</p>
            <button id="checkout-button">Оформить заказ</button>
            <!-- Кнопка оплаты -->
        </div>
    </div>


    <!-- Модальное окно оформления заказа -->
    <div id="order-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-order-modal">×</span>
            <h3>Оформление заказа</h3>
            <label for="phone">Введите ваш номер телефона:</label>
            <input type="tel" id="phone" name="phone" value="+375 " required>

            <button id="submit-order" class="order-button">Отправить заказ</button>
        </div>
    </div>

    <div id="toast" class="toast">Заказ успешно оформлен!</div>


    <footer>
        <p>© 2025 Моти в Мозыре. Все права защищены.</p>
    </footer>






    <script>


        //Модальное окно товара
        document.addEventListener("DOMContentLoaded", () => {
            const productCards = document.querySelectorAll(".product-card");
            const modal = document.getElementById("modal");
            const modalImage = document.getElementById("modal-image");
            const modalTitle = document.getElementById("modal-title");
            const modalDescription = document.getElementById("modal-description");
            const modalIngredients = document.getElementById("modal-ingredients");
            const catalog = document.getElementById("catalog");
            const closeButtons = document.querySelectorAll(".close-button");

            // Данные о товарах
            const productData = {
                "Апельсин": {
                    description: "Сочный и свежий апельсин, богатый витамином C.",
                    ingredients: "Апельсин 100%"
                },
                "Клубника в молочном шоколаде": {
                    description: "Сладкая клубника, покрытая нежным молочным шоколадом.",
                    ingredients: "Клубника, молочный шоколад"
                },
                "Медовик с орехами": {
                    description: "Классический медовый торт с добавлением орехов.",
                    ingredients: "Мёд, мука, орехи, сахар"
                },
                "Шоколад с малиной": {
                    description: "Классический медовый торт с добавлением орехов.",
                    ingredients: "Мёд, мука, орехи, сахар"
                },
                "Чёрная смородина": {
                    description: "Классический медовый торт с добавлением орехов.",
                    ingredients: "Мёд, мука, орехи, сахар"
                },
                "Клубника со сливками и белым шоколадом": {
                    description: "Классический медовый торт с добавлением орехов.",
                    ingredients: "Мёд, мука, орехи, сахар"
                },
                "Цитрус с маком": {
                    description: "Классический медовый торт с добавлением орехов.",
                    ingredients: "Мёд, мука, орехи, сахар"
                },
                "Матча с клубникой": {
                    description: "Классический медовый торт с добавлением орехов.",
                    ingredients: "Мёд, мука, орехи, сахар"
                },

            };

            // Открытие модального окна (только при клике на карточку, НЕ на кнопку!)
            productCards.forEach(card => {
                card.addEventListener("click", (event) => {
                    if (event.target.classList.contains("add-to-cart")) {
                        return; // Прерываем, если клик был на кнопке
                    }

                    const imageSrc = card.getAttribute("data-image");
                    const productName = card.querySelector(".product-title").textContent;

                    modalImage.src = imageSrc;
                    modalTitle.textContent = productName;

                    if (productData[productName]) {
                        modalDescription.textContent = productData[productName].description;
                        modalIngredients.textContent = "Состав: " + productData[productName].ingredients;
                    } else {
                        modalDescription.textContent = "Описание отсутствует.";
                        modalIngredients.textContent = "";
                    }

                    modal.style.display = "flex";
                    catalog.style.display = "none"; // Скрываем каталог
                });
            });

            // Закрытие модального окна при клике на .close-button
            closeButtons.forEach(button => {
                button.addEventListener("click", () => {
                    modal.style.display = "none";
                    catalog.style.display = "block";
                });
            });

            // Закрытие при клике вне окна
            modal.addEventListener("click", (event) => {
                if (event.target === modal) {
                    modal.style.display = "none";
                    catalog.style.display = "block";
                }
            });
        });


        document.getElementById('checkout-button').textContent = 'Оформление заказа';
        document.getElementById('checkout-button').addEventListener('click', function () {
            document.getElementById('order-modal').style.display = 'block';
        });

        document.getElementById('close-order-modal').addEventListener('click', function () {
            document.getElementById('order-modal').style.display = 'none';
        });

        window.addEventListener('click', function (event) {
            const modal = document.getElementById('order-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });

        function showToast(message, isError = false) {
            const toast = document.getElementById("toast");
            toast.textContent = message;
            toast.classList.add("show");

            if (isError) {
                toast.style.backgroundColor = "#ff4d4d"; // Красный цвет для ошибок
            } else {
                toast.style.backgroundColor = "#4CAF50"; // Зелёный для успеха
            }

            setTimeout(() => {
                toast.classList.remove("show");
            }, 5000); // Скрываем через 3 секунды
        }

        document.getElementById('submit-order').addEventListener('click', () => {
            const phone = document.getElementById('phone').value;

            if (!phone) {
                showToast('Введите номер телефона! 📱', true);
                return;
            }

            const cartData = Object.entries(cart).map(([product, { quantity, price }]) => ({
                product,
                quantity,
                price
            }));

            if (cartData.length === 0) {
                showToast('Корзина пуста! 🛒 Добавьте товары перед заказом.', true);
                return;
            }

            // Добавляем логирование перед отправкой
            console.log("Отправляемые данные:");
            console.log("Телефон:", phone);
            console.log("Корзина (cartData):", cartData);
            console.log("Данные в формате JSON:", JSON.stringify({ phone, cart: cartData }));

            fetch('https://ch41555.tw1.ru/order', { // Полный URL
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ phone, cart: cartData })
            })
                .then(response => {
                    // Добавляем логирование ответа
                    console.log("Ответ от сервера:", response);
                    return response.json(); // Парсим ответ как JSON
                })
                .then(data => {
                    // Добавляем логирование данных, полученных от сервера
                    console.log("Данные от сервера:", data);
                    showToast('Заказ успешно оформлен! 🎉 Наш оператор вскоре свяжется с вами ⌛');
                    document.getElementById('order-modal').style.display = 'none';
                })
                .catch(error => {
                    // Добавляем логирование ошибок
                    console.error('Ошибка:', error);
                    showToast('Ошибка при оформлении заказа ❌', true);
                });
        });

        // Объект для хранения товаров
        let cart = {}; // Объект для хранения товаров

        document.addEventListener("DOMContentLoaded", function () {


            function updateCartDisplay() {
                const cartItemsContainer = document.getElementById("cart-items");
                const cartCounter = document.getElementById("cart-counter");
                cartItemsContainer.innerHTML = "";
                let totalPrice = 0;
                let totalQuantity = 0;

                Object.keys(cart).forEach(product => {
                    const item = cart[product];
                    const itemElement = document.createElement("div");
                    itemElement.classList.add("cart-item");

                    const itemName = document.createElement("span1");
                    itemName.textContent = `${product} `;

                    const minusButton = document.createElement("button");
                    minusButton.textContent = "-";
                    minusButton.classList.add("quantity-button");
                    minusButton.addEventListener("click", () => {
                        if (cart[product].quantity > 1) {
                            cart[product].quantity--;
                        } else {
                            delete cart[product];
                        }
                        updateCartDisplay();
                    });

                    const quantityDisplay = document.createElement("span");
                    quantityDisplay.textContent = ` x${item.quantity} `;

                    const plusButton = document.createElement("button");
                    plusButton.textContent = "+";
                    plusButton.classList.add("quantity-button");
                    plusButton.addEventListener("click", () => {
                        cart[product].quantity++;
                        updateCartDisplay();
                    });

                    const itemPrice = document.createElement("span3");
                    const totalItemPrice = item.price * item.quantity;
                    itemPrice.textContent = ` — ${totalItemPrice.toFixed(2)} BYN`;

                    totalPrice += totalItemPrice;
                    totalQuantity += item.quantity;

                    itemElement.appendChild(itemName);
                    itemElement.appendChild(minusButton);
                    itemElement.appendChild(quantityDisplay);
                    itemElement.appendChild(plusButton);
                    itemElement.appendChild(itemPrice);

                    cartItemsContainer.appendChild(itemElement);
                });

                document.getElementById("total-price").textContent = `Итого: ${totalPrice.toFixed(2)} BYN`;
                cartCounter.textContent = totalQuantity;
                cartCounter.style.display = totalQuantity > 0 ? "block" : "none";
            }

            document.querySelectorAll(".add-to-cart").forEach(button => {
                button.addEventListener("click", function () {
                    const product = this.getAttribute("data-product");
                    const price = parseFloat(this.getAttribute("data-price")) || 0;

                    if (cart[product]) {
                        cart[product].quantity++;
                    } else {
                        cart[product] = { quantity: 1, price };
                    }


                    updateCartDisplay();
                });
            });
        });


        // Управление всплывающей корзиной
        const cartButton = document.querySelector('.cart-button');
        const cartPopup = document.getElementById('cart-popup');
        const cartCloseButton = document.getElementById('cart-close');
        let timeoutId;
        let delay = 700;
        let isHovering = false;

        if (cartButton && cartPopup) {
            cartButton.addEventListener('mouseover', () => {
                clearTimeout(timeoutId);
                cartPopup.style.display = 'block';
            });

            cartButton.addEventListener('mouseout', (event) => {
                timeoutId = setTimeout(() => {
                    if (!cartPopup.contains(event.relatedTarget) && !cartButton.contains(event.relatedTarget)) {
                        cartPopup.style.display = 'none';
                    }
                }, delay);
            });

            cartPopup.addEventListener('mouseover', () => {
                clearTimeout(timeoutId);
                cartPopup.style.display = 'block';
                isHovering = true;
            });

            cartPopup.addEventListener('mouseout', () => {
                cartPopup.style.display = 'none';
                isHovering = false;
            });

            cartCloseButton?.addEventListener('click', () => {
                cartPopup.style.display = 'none';
                isHovering = false;
            });
        }

        // Скролл к каталогу
        document.getElementById('order-button')?.addEventListener('click', () => {
            document.getElementById('catalog').scrollIntoView({
                behavior: 'smooth'
            });
        });

        // Управление модальными окнами
        const modalButtons = document.querySelectorAll('.nav-button, .buttons button[data-modal]');
        modalButtons.forEach(button => {
            button.addEventListener('click', () => {
                const modalId = button.getAttribute('data-modal');
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'block';
                }
            });
        });

        const closeButtons = document.querySelectorAll('.close-button');
        closeButtons.forEach(button => {
            button.addEventListener('click', () => {
                const modal = button.closest('.modal');
                if (modal) {
                    modal.style.display = 'none';
                }
            });
        });


        window.addEventListener('click', (event) => {
            document.querySelectorAll('.modal').forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // Форматирование номера телефона
        document.getElementById("phone").addEventListener("input", function () {
            let value = this.value.replace(/\D/g, ""); // Удаляем все нецифровые символы

            if (value.length === 0) {
                this.value = "";
                return;
            }

            // Определяем код страны (первая цифра после "+")
            let countryCode = "";
            let restNumber = "";

            if (value.startsWith("1")) { // США, Канада (+1)
                countryCode = "+1";
                restNumber = value.slice(1);
            } else if (value.startsWith("7")) { // Россия, Казахстан (+7)
                countryCode = "+7";
                restNumber = value.slice(1);
            } else if (value.startsWith("375")) { // Беларусь (+375)
                countryCode = "+375";
                restNumber = value.slice(3);
            } else if (value.startsWith("380")) { // Украина (+380)
                countryCode = "+380";
                restNumber = value.slice(3);
            } else { // Другие страны (например, Европа)
                countryCode = "+" + value.slice(0, 3);
                restNumber = value.slice(3);
            }

            // Применяем форматирование
            let formatted = countryCode;
            if (restNumber.length > 0) formatted += " (" + restNumber.substring(0, 2);
            if (restNumber.length > 2) formatted += ") " + restNumber.substring(2, 5);
            if (restNumber.length > 5) formatted += "-" + restNumber.substring(5, 7);
            if (restNumber.length > 7) formatted += "-" + restNumber.substring(7, 9);

            this.value = formatted;

        });
    </script>
</body>

</html>
